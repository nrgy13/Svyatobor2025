# ðŸš€ ÐŸÐ¾ÑˆÐ°Ð³Ð¾Ð²Ñ‹Ðµ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ð¸ Ð¿Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸ÑŽ Ð´ÐµÐ¿Ð»Ð¾Ñ Ð½Ð° Timeweb

## ðŸ“‹ ÐžÐ±Ð·Ð¾Ñ€ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹ Ð´ÐµÐ¿Ð»Ð¾Ñ

**Ð¢ÐµÐºÑƒÑ‰Ð°Ñ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ:**
- **ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ð¼ÐµÑ‚Ð¾Ð´:** SSH + rsync
- **Ð¢Ð¸Ð¿ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ:** Next.js ÑÐ¾ ÑÑ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸ÐµÐ¹
- **Ð¦ÐµÐ»ÐµÐ²Ð¾Ð¹ ÑÐµÑ€Ð²ÐµÑ€:** Timeweb Cloud
- **ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ñ‹:** `deploy.sh`, `init-deploy.sh`

**ÐÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ñ‹Ðµ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ:**
- `SSH_HOST`, `SSH_USER`, `SSH_KEY_PATH` (Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ð¼ÐµÑ‚Ð¾Ð´)
- `FTP_HOST`, `FTP_USER`, `FTP_PASS` (Ð°Ð»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð°)
- `REMOTE_PATH`, `PRODUCTION_DOMAIN`
- ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Supabase

---

## 1. ðŸ”§ ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ðº Ð´ÐµÐ¿Ð»Ð¾ÑŽ

### 1.1 ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ñ… Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ð¹

**Ð”Ð»Ñ Windows (PowerShell):**
```powershell
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ñ Node.js
node --version

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ñ Git
git --version

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ñ SSH ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°
ssh -V

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ñ rsync (Ñ‡ÐµÑ€ÐµÐ· Git Bash Ð¸Ð»Ð¸ WSL)
rsync --version
```

**Ð”Ð»Ñ Linux/macOS:**
```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ñ… Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹
node --version
git --version
ssh -V
rsync --version
```

### 1.2 ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ

Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð¸Ð»Ð¸ Ð¾Ð±Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Ñ„Ð°Ð¹Ð» `.env.deploy`:

```bash
# SSH ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ (Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ð¼ÐµÑ‚Ð¾Ð´)
SSH_HOST="your-server.timeweb.ru"
SSH_USER="your-username"
SSH_KEY_PATH="~/.ssh/timeweb_key"

# ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ð°Ñ FTP ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ
FTP_HOST="your-server.timeweb.ru"
FTP_USER="your-ftp-username"
FTP_PASS="your-ftp-password"

# ÐŸÑƒÑ‚Ð¸ Ð¸ Ð´Ð¾Ð¼ÐµÐ½Ñ‹
REMOTE_PATH="/var/www/html"
PRODUCTION_DOMAIN="your-domain.com"

# Supabase Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ (Ð´Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð¸Ð· .env)
NEXT_PUBLIC_SUPABASE_URL="your_supabase_url"
NEXT_PUBLIC_SUPABASE_ANON_KEY="your_supabase_anon_key"
SUPABASE_SERVICE_ROLE_KEY="your_supabase_service_role_key"
```

### 1.3 ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° SSH Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°

**Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ SSH ÐºÐ»ÑŽÑ‡Ð° (ÐµÑÐ»Ð¸ Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚):**
```bash
# Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð½Ð¾Ð²Ð¾Ð³Ð¾ SSH ÐºÐ»ÑŽÑ‡Ð°
ssh-keygen -t rsa -b 4096 -C "deploy@your-domain.com" -f ~/.ssh/timeweb_key

# Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÐºÐ»ÑŽÑ‡Ð° Ð² SSH Ð°Ð³ÐµÐ½Ñ‚
ssh-add ~/.ssh/timeweb_key

# ÐšÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ð¾Ð³Ð¾ ÐºÐ»ÑŽÑ‡Ð° Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€
ssh-copy-id -i ~/.ssh/timeweb_key.pub SSH_USER@SSH_HOST
```

**ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° SSH ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ñ:**
```bash
# Ð¢ÐµÑÑ‚ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ
ssh -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST "echo 'SSH connection successful'"

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ñ€Ð°Ð² Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº Ñ†ÐµÐ»ÐµÐ²Ð¾Ð¹ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ð¸
ssh -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST "ls -la REMOTE_PATH"
```

### 1.4 ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°

```bash
# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹
npm install

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ±Ð¾Ñ€ÐºÐ¸ Ð² Ñ€ÐµÐ¶Ð¸Ð¼Ðµ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸
npm run build

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ñ Ð¾ÑˆÐ¸Ð±Ð¾Ðº Ð»Ð¸Ð½Ñ‚Ð¸Ð½Ð³Ð°
npm run lint
```

---

## 2. ðŸ”¨ ÐŸÑ€Ð¾Ñ†ÐµÑÑ ÑÐ±Ð¾Ñ€ÐºÐ¸ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ

### 2.1 Ð›Ð¾ÐºÐ°Ð»ÑŒÐ½Ð°Ñ ÑÐ±Ð¾Ñ€ÐºÐ°

**Ð¡Ñ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ð°Ñ ÑÐ±Ð¾Ñ€ÐºÐ°:**
```bash
# Ð¡Ð±Ð¾Ñ€ÐºÐ° Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð´Ð°ÐºÑˆÐµÐ½Ð°
npm run build

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ¾Ð·Ð´Ð°Ð½Ð½Ñ‹Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð²
ls -la out/
```

**ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð²:**
```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ñ Ð¾ÑÐ½Ð¾Ð²Ð½Ñ‹Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð² ÑÐ±Ð¾Ñ€ÐºÐ¸
test -f "out/index.html" && echo "âœ… index.html Ð½Ð°Ð¹Ð´ÐµÐ½" || echo "âŒ index.html Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚"
test -f "out/.htaccess" && echo "âœ… .htaccess Ð½Ð°Ð¹Ð´ÐµÐ½" || echo "âŒ .htaccess Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚"

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ€Ð°Ð·Ð¼ÐµÑ€Ð° ÑÐ±Ð¾Ñ€ÐºÐ¸
du -sh out/
```

### 2.2 ÐŸÑ€ÐµÐ´Ð´ÐµÐ¿Ð»Ð¾Ð¹Ð½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ°

**Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ ÑÐ±Ð¾Ñ€ÐºÐ¸:**
```bash
# Ð—Ð°Ð¿ÑƒÑÐº ÑÐºÑ€Ð¸Ð¿Ñ‚Ð° Ð´ÐµÐ¿Ð»Ð¾Ñ Ð² Ñ‚ÐµÑÑ‚Ð¾Ð²Ð¾Ð¼ Ñ€ÐµÐ¶Ð¸Ð¼Ðµ (Ð±ÐµÐ· Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸)
./deploy.sh production --dry-run  # (ÐµÑÐ»Ð¸ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð° Ð¾Ð¿Ñ†Ð¸Ñ dry-run)

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð»Ð¾Ð³Ð¾Ð² ÑÐ±Ð¾Ñ€ÐºÐ¸
ls -la logs/
```

---

## 3. ðŸ“¤ Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€

### 3.1 ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ð´ÐµÐ¿Ð»Ð¾Ð¹ Ñ‡ÐµÑ€ÐµÐ· SSH

**ÐŸÐ¾Ð»Ð½Ñ‹Ð¹ Ð´ÐµÐ¿Ð»Ð¾Ð¹:**
```bash
# Ð—Ð°Ð¿ÑƒÑÐº Ð´ÐµÐ¿Ð»Ð¾Ñ Ð² Ð¿Ñ€Ð¾Ð´Ð°ÐºÑˆÐ½
./deploy.sh production

# ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ð¾ Ð´Ð»Ñ staging
./deploy.sh staging
```

**Ð§Ñ‚Ð¾ Ð¿Ñ€Ð¾Ð¸ÑÑ…Ð¾Ð´Ð¸Ñ‚ Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ð´ÐµÐ¿Ð»Ð¾Ñ:**
1. âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ
2. âœ… Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ ÑÐ±Ð¾Ñ€ÐºÐ¸ Ð¸Ð»Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ `npm run build`
3. âœ… Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ð¹ ÐºÐ¾Ð¿Ð¸Ð¸ (Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð´Ð°ÐºÑˆÐµÐ½Ð°)
4. âœ… Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ„Ð°Ð¹Ð»Ð¾Ð² Ñ‡ÐµÑ€ÐµÐ· rsync
5. âœ… Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹ Ð¸Ð· Ð¿Ð°Ð¿Ð¾Ðº `images/` Ð¸ `public/images/`
6. âœ… ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¿Ñ€Ð°Ð² Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° (755)
7. âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹
8. âœ… ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº Ð²ÐµÐ±-ÑÐµÑ€Ð²ÐµÑ€Ð°
9. âœ… ÐŸÐ¾ÑÑ‚-Ð´ÐµÐ¿Ð»Ð¾Ð¹Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸

### 3.2 ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð´ÐµÐ¿Ð»Ð¾Ð¹ Ñ‡ÐµÑ€ÐµÐ· FTP

**Ð•ÑÐ»Ð¸ SSH Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½:**
```bash
# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° lftp (ÐµÑÐ»Ð¸ Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚)
# Ð”Ð»Ñ Ubuntu/Debian: sudo apt-get install lftp
# Ð”Ð»Ñ CentOS/RHEL: sudo yum install lftp
# Ð”Ð»Ñ macOS: brew install lftp

# Ð”ÐµÐ¿Ð»Ð¾Ð¹ Ñ‡ÐµÑ€ÐµÐ· FTP
FTP_HOST="your-server.timeweb.ru" \
FTP_USER="your-ftp-username" \
FTP_PASS="your-ftp-password" \
./deploy.sh production
```

### 3.3 ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ° Ð´ÐµÐ¿Ð»Ð¾Ñ

**ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑÐ° Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸:**
```bash
# Ð—Ð°Ð¿ÑƒÑÐº Ð´ÐµÐ¿Ð»Ð¾Ñ Ñ Ð¿Ð¾Ð´Ñ€Ð¾Ð±Ð½Ñ‹Ð¼ Ð²Ñ‹Ð²Ð¾Ð´Ð¾Ð¼
./deploy.sh production | tee deploy-$(date +%Y%m%d-%H%M%S).log

# ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð»Ð¾Ð³Ð¾Ð² ÑÐµÑ€Ð²ÐµÑ€Ð° Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ð´ÐµÐ¿Ð»Ð¾Ñ
ssh -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST "tail -f /var/log/nginx/access.log"
```

---

## 4. ðŸ” ÐŸÐ¾ÑÑ‚-Ð´ÐµÐ¿Ð»Ð¾Ð¹Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸

### 4.1 ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸ ÑÐ°Ð¹Ñ‚Ð°

**ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ°:**
```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° HTTP ÑÑ‚Ð°Ñ‚ÑƒÑÐ°
Invoke-WebRequest -Uri "https://PRODUCTION_DOMAIN/" -Method HEAD

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸ Ð³Ð»Ð°Ð²Ð½Ð¾Ð¹ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹
$response = Invoke-WebRequest -Uri "https://PRODUCTION_DOMAIN/"
$response.Content | Select-Object -First 20

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹
Invoke-WebRequest -Uri "https://PRODUCTION_DOMAIN/" -Method HEADimages/
Invoke-WebRequest -Uri "https://PRODUCTION_DOMAIN/" -Method HEADpublic/images/
```

**Ð ÑƒÑ‡Ð½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ°:**
1. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ ÑÐ°Ð¹Ñ‚ Ð² Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ðµ
2. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ Ð²ÑÐµÑ… Ð¾ÑÐ½Ð¾Ð²Ð½Ñ‹Ñ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹
3. Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ Ð² ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾Ð¹ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐµ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹
4. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ðµ Ð¾ÑˆÐ¸Ð±Ð¾Ðº Ð² ÐºÐ¾Ð½ÑÐ¾Ð»Ð¸ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ð°

### 4.2 ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ€Ð°Ð±Ð¾Ñ‚Ð¾ÑÐ¿Ð¾ÑÐ¾Ð±Ð½Ð¾ÑÑ‚Ð¸ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ

**SSH ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð´Ð»Ñ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ¸:**
```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑ‚Ð°Ñ‚ÑƒÑÐ° Ð²ÐµÐ±-ÑÐµÑ€Ð²ÐµÑ€Ð°
ssh -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST "sudo systemctl status nginx"

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ð´Ð¸ÑÐºÐ¾Ð²Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²Ð°
ssh -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST "df -h"

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ñ… Ð»Ð¾Ð³Ð¾Ð² Ð¾ÑˆÐ¸Ð±Ð¾Ðº
ssh -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST "sudo tail -50 /var/log/nginx/error.log"

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ¾Ð² Node.js (ÐµÑÐ»Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ)
ssh -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST "ps aux | grep node"
```

### 4.3 ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ

**Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾ÑÐ½Ð¾Ð²Ð½Ñ‹Ñ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹:**
```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° API endpoints (ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ)
$response = Invoke-WebRequest -Uri "https://PRODUCTION_DOMAIN/api/health"
$response.Content || echo "API endpoint Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½"

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Supabase Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ
$response = Invoke-WebRequest -Uri "https://PRODUCTION_DOMAIN/"
if ($response.Content -match "supabase") {
    Write-Host "Supabase Ð½Ð°Ð¹Ð´ÐµÐ½ Ð½Ð° Ð³Ð»Ð°Ð²Ð½Ð¾Ð¹ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ"
} else {
    Write-Host "Supabase Ð½Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð½Ð° Ð³Ð»Ð°Ð²Ð½Ð¾Ð¹ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ"
}
```

---

## 5. âª ÐžÑ‚ÐºÐ°Ñ‚ Ð² ÑÐ»ÑƒÑ‡Ð°Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼

### 5.1 ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¾Ñ‚ÐºÐ°Ñ‚

**Ð•ÑÐ»Ð¸ Ð´ÐµÐ¿Ð»Ð¾Ð¹ Ð·Ð°Ð²ÐµÑ€ÑˆÐ¸Ð»ÑÑ Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ¾Ð¹:**
```bash
# Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¸Ð· Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ð¹ ÐºÐ¾Ð¿Ð¸Ð¸
ssh -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST "cp -r BACKUP_DIR/* REMOTE_PATH/"

# ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº Ð²ÐµÐ±-ÑÐµÑ€Ð²ÐµÑ€Ð° Ð¿Ð¾ÑÐ»Ðµ Ð¾Ñ‚ÐºÐ°Ñ‚Ð°
ssh -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST "sudo systemctl restart nginx"
```

### 5.2 Ð ÑƒÑ‡Ð½Ð¾Ð¹ Ð¾Ñ‚ÐºÐ°Ñ‚

**ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð¾Ñ‚ÐºÐ°Ñ‚Ð° Ð·Ð°Ñ€Ð°Ð½ÐµÐµ:**
```bash
# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð° Ð¾Ñ‚ÐºÐ°Ñ‚Ð°
cat > rollback.sh << 'EOF'
#!/bin/bash
BACKUP_DIR="backup/$(ls -t backup/ | head -1)"
echo "Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÑŽ Ð¸Ð· Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ð¹ ÐºÐ¾Ð¿Ð¸Ð¸: $BACKUP_DIR"
scp -r $BACKUP_DIR/* SSH_USER@SSH_HOST:REMOTE_PATH/
ssh -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST "sudo systemctl restart nginx"
EOF

chmod +x rollback.sh
```

### 5.3 ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ð¾ÑÐ»Ðµ Ð¾Ñ‚ÐºÐ°Ñ‚Ð°

```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸ ÑÐ°Ð¹Ñ‚Ð° Ð¿Ð¾ÑÐ»Ðµ Ð¾Ñ‚ÐºÐ°Ñ‚Ð°
Invoke-WebRequest -Uri "https://PRODUCTION_DOMAIN/" -Method HEAD

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸ Ð¿Ð¾ÑÐ»Ðµ Ð¾Ñ‚ÐºÐ°Ñ‚Ð°
$response = Invoke-WebRequest -Uri "https://PRODUCTION_DOMAIN/"
if ($response.Content -match "error") {
    Write-Host "ÐÐ°Ð¹Ð´ÐµÐ½Ñ‹ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ"
} else {
    Write-Host "ÐžÑˆÐ¸Ð±Ð¾Ðº Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾"
}
```

---

## 6. ðŸ“Š ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¸ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

### 6.1 ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ

**Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ:**
```bash
# Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð² deploy.sh
LOG_FILE="logs/deploy-$(date +%Y%m%d-%H%M%S).log"

# ÐŸÐµÑ€ÐµÐ½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð²ÑÐµÐ³Ð¾ Ð²Ñ‹Ð²Ð¾Ð´Ð° Ð² Ð»Ð¾Ð³
./deploy.sh production 2>&1 | tee $LOG_FILE
```

### 6.2 ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸

**ÐšÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°:**
```bash
# ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº ÑÐ°Ð¹Ñ‚Ñƒ
ssh -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST "sudo tail -f /var/log/nginx/access.log"

# ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¾ÑˆÐ¸Ð±Ð¾Ðº
ssh -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST "sudo tail -f /var/log/nginx/error.log"

# ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ñ€ÐµÑÑƒÑ€ÑÐ¾Ð²
ssh -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST "htop || top"
```

### 6.3 ÐÐ½Ð°Ð»Ð¸Ð· Ð»Ð¾Ð³Ð¾Ð² Ð´ÐµÐ¿Ð»Ð¾Ñ

**ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸ Ð´ÐµÐ¿Ð»Ð¾ÐµÐ²:**
```bash
# Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð²ÑÐµÑ… Ð»Ð¾Ð³Ð¾Ð² Ð´ÐµÐ¿Ð»Ð¾Ñ
ls -la logs/deploy-*.log | tail -5

# ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð´ÐµÐ¿Ð»Ð¾Ñ
tail -100 logs/deploy-$(ls -t logs/deploy-*.log | head -1)

# ÐŸÐ¾Ð¸ÑÐº Ð¾ÑˆÐ¸Ð±Ð¾Ðº Ð² Ð»Ð¾Ð³Ð°Ñ…
grep -i "error" logs/deploy-*.log
```

### 6.4 ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ð¹

**Telegram ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¾ Ð´ÐµÐ¿Ð»Ð¾Ðµ:**
```bash
# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° telegram-bot (npm install -g telegram-bot)
# ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð±Ð¾Ñ‚Ð° Ð¸ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð² deploy.sh

curl -s -X POST https://api.telegram.org/bot$TELEGRAM_BOT_TOKEN/sendMessage \
  -d chat_id=$TELEGRAM_CHAT_ID \
  -d text="ðŸš€ Ð”ÐµÐ¿Ð»Ð¾Ð¹ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½: $PRODUCTION_DOMAIN" \
  -d parse_mode="Markdown"
```

---

## 7. ðŸ› ï¸ Ð£ÑÑ‚Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð½ÐµÐ¿Ð¾Ð»Ð°Ð´Ð¾Ðº

### 7.1 Ð Ð°ÑÐ¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÐµÐ½Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹

**ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°: "Permission denied" Ð¿Ñ€Ð¸ SSH Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ð¸**
```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ñ€Ð°Ð² Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº SSH ÐºÐ»ÑŽÑ‡Ñƒ
chmod 600 ~/.ssh/timeweb_key
chmod 644 ~/.ssh/timeweb_key.pub

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° SSH Ð°Ð³ÐµÐ½Ñ‚Ð°
ssh-add -l

# Ð¢ÐµÑÑ‚ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ñ verbose Ð²Ñ‹Ð²Ð¾Ð´Ð¾Ð¼
ssh -v -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST
```

**ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°: ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ±Ð¾Ñ€ÐºÐ¸ Next.js**
```bash
# ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° ÐºÑÑˆÐ° Next.js
rm -rf .next out node_modules/.cache

# ÐŸÐµÑ€ÐµÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹
rm -rf node_modules package-lock.json
npm install

# Ð¡Ð±Ð¾Ñ€ÐºÐ° Ñ Ð¿Ð¾Ð´Ñ€Ð¾Ð±Ð½Ñ‹Ð¼ Ð²Ñ‹Ð²Ð¾Ð´Ð¾Ð¼
npm run build --verbose
```

**ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°: Ð˜Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ð½Ðµ Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÑŽÑ‚ÑÑ**
```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¿Ð°Ð¿Ð¾Ðº Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾
ls -la images/ public/images/

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ñ€Ð°Ð² Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ
ssh -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST "ls -la REMOTE_PATH/images/"

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ð¾Ð³Ð¾ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°
Invoke-WebRequest -Uri "https://PRODUCTION_DOMAIN/" -Method HEADimages/$(ls images/ | head -1)
```

### 7.2 Ð”Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹

**ÐŸÐ¾Ð»Ð½Ð°Ñ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ° Ð´ÐµÐ¿Ð»Ð¾Ñ:**
```bash
# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð°
cat > diagnose-deploy.sh << 'EOF'
#!/bin/bash
echo "=== Ð”Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ° Ð´ÐµÐ¿Ð»Ð¾Ñ ==="
echo "1. Ð›Ð¾ÐºÐ°Ð»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ°:"
test -f "out/index.html" && echo "âœ… Ð¡Ð±Ð¾Ñ€ÐºÐ° ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚" || echo "âŒ Ð¡Ð±Ð¾Ñ€ÐºÐ° Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚"
test -d "images" && echo "âœ… ÐŸÐ°Ð¿ÐºÐ° images ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚" || echo "âŒ ÐŸÐ°Ð¿ÐºÐ° images Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚"

echo "2. SSH Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ°:"
ssh -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST "echo 'SSH OK'" || echo "âŒ SSH Ð¾ÑˆÐ¸Ð±ÐºÐ°"

echo "3. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐµÑ€Ð²ÐµÑ€Ð°:"
ssh -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST "ls -la REMOTE_PATH/"

echo "4. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð²ÐµÐ±-ÑÐµÑ€Ð²ÐµÑ€Ð°:"
Invoke-WebRequest -Uri "https://PRODUCTION_DOMAIN/" -Method HEAD
EOF

chmod +x diagnose-deploy.sh
./diagnose-deploy.sh
```

---

## 8. âš¡ ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¸ Ð»ÑƒÑ‡ÑˆÐ¸Ðµ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸

### 8.1 Ð£ÑÐºÐ¾Ñ€ÐµÐ½Ð¸Ðµ Ð´ÐµÐ¿Ð»Ð¾Ñ

**ÐŸÐ°Ñ€Ð°Ð»Ð»ÐµÐ»ÑŒÐ½Ð°Ñ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°:**
```bash
# ÐžÐ´Ð½Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð¸ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹
./deploy.sh production &
DEPLOY_PID=$!

# ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑÐ°
wait $DEPLOY_PID
```

### 8.2 ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð´ÐµÐ¿Ð»Ð¾Ñ

**GitHub Actions Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ:**
```bash
# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ workflow Ñ„Ð°Ð¹Ð»Ð° .github/workflows/deploy.yml
# (ÑƒÐ¶Ðµ Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾ Ð² init-deploy.sh)

# ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° ÑÐµÐºÑ€ÐµÑ‚Ð¾Ð² Ð² GitHub Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¸:
# FTP_USER, FTP_PASS, SSH_KEY, PRODUCTION_DOMAIN
```

### 8.3 Ð ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

**ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ:**
```bash
# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÐµÐ¶ÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ñ… Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ñ‹Ñ… ÐºÐ¾Ð¿Ð¸Ð¹
echo "0 2 * * * scp -r SSH_USER@SSH_HOST:REMOTE_PATH backup/daily-$(date +%Y%m%d)" | crontab -

# ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° ÑÑ‚Ð°Ñ€Ñ‹Ñ… Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ñ‹Ñ… ÐºÐ¾Ð¿Ð¸Ð¹ (ÑÑ‚Ð°Ñ€ÑˆÐµ 30 Ð´Ð½ÐµÐ¹)
find backup/ -type d -mtime +30 -exec rm -rf {} \;
```

---

## ðŸ“ž ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ð¸ ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñ‹

**Ð‘Ñ‹ÑÑ‚Ñ€Ð°Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ:**
- ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð»Ð¾Ð³Ð¸ Ð´ÐµÐ¿Ð»Ð¾Ñ: `tail -100 logs/deploy-$(ls -t logs/deploy-*.log | head -1)`
- Ð¢ÐµÑÑ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ SSH Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ: `ssh -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST`
- ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ ÑÑ‚Ð°Ñ‚ÑƒÑ ÑÐµÑ€Ð²ÐµÑ€Ð°: `Invoke-WebRequest -Uri "https://PRODUCTION_DOMAIN/" -Method HEAD`

**Ð­ÐºÑÑ‚Ñ€ÐµÐ½Ð½Ñ‹Ð¹ Ð¾Ñ‚ÐºÐ°Ñ‚:**
```bash
# Ð•ÑÐ»Ð¸ ÑÐ°Ð¹Ñ‚ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½
./rollback.sh || ssh -i ~/.ssh/timeweb_key SSH_USER@SSH_HOST "sudo systemctl restart nginx"
```

---

*ÐŸÐ¾ÑÐ»ÐµÐ´Ð½ÐµÐµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ: $(date)*
*Ð’ÐµÑ€ÑÐ¸Ñ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ð¸: 1.0*