# ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ GitHub Actions

## üìã –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –¥–ª—è:**
- üöÄ –î–µ–ø–ª–æ–π –ø—Ä–∏ –ø—É—à–µ –≤ –≤–µ—Ç–∫—É `main`
- üîç –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏ Pull Request
- üì¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- üíæ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã

–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (`Settings > Secrets and variables > Actions`) –¥–æ–±–∞–≤—å—Ç–µ:

```bash
# SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É
SSH_HOST=–í–ê–®_–°–ï–†–í–ï–†.timeweb.ru
SSH_USER=–í–ê–®_–õ–û–ì–ò–ù_–ù–ê_–°–ï–†–í–ï–†–ï
SSH_KEY=-----BEGIN OPENSSH PRIVATE KEY-----
(–≤–∞—à –ø—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á)
-----END OPENSSH PRIVATE KEY-----

# –î–æ–º–µ–Ω –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
PRODUCTION_DOMAIN=svyatobor.ru
```

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã (–¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π)

```bash
# Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
TELEGRAM_BOT_TOKEN=–≤–∞—à_–±–æ—Ç_—Ç–æ–∫–µ–Ω
TELEGRAM_CHAT_ID=–≤–∞—à_—á–∞—Ç_id
```

## üîë –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SSH –∫–ª—é—á–∞ –¥–ª—è –¥–µ–ø–ª–æ—è

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª—é—á–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –¥–µ–ø–ª–æ—è
ssh-keygen -t rsa -b 4096 -C "github-actions-deploy@svyatobor.ru" -f ~/.ssh/github_actions_key

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh-copy-id -i ~/.ssh/github_actions_key.pub –í–ê–®_–õ–û–ì–ò–ù@–í–ê–®_–°–ï–†–í–ï–†.timeweb.ru

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
ssh -i ~/.ssh/github_actions_key –í–ê–®_–õ–û–ì–ò–ù@–í–ê–®_–°–ï–†–í–ï–†.timeweb.ru "echo 'SSH OK'"
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –¥–µ–ø–ª–æ—è

```
.github/
‚îî‚îÄ‚îÄ workflows/
    ‚îî‚îÄ‚îÄ deploy.yml              # –û—Å–Ω–æ–≤–Ω–æ–π workflow

deploy-github-actions.sh        # –°–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è –¥–ª—è CI/CD
DEPLOY_INSTRUCTIONS.md          # –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
DEPLOY_READINESS_REPORT.md      # –û—Ç—á–µ—Ç –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
```

## üöÄ –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π (–ø—Ä–∏ –ø—É—à–µ –≤ main):

1. **üì• Checkout –∫–æ–¥–∞** - –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏
2. **üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Node.js** - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. **üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** - `npm ci`
4. **üèóÔ∏è –°–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** - `npm run build`
5. **üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–±–æ—Ä–∫–∏** - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
6. **üì§ –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä** - –ó–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ rsync
7. **üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤** - 755 –¥–ª—è –ø–∞–ø–æ–∫, 644 –¥–ª—è —Ñ–∞–π–ª–æ–≤
8. **üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ nginx** - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
9. **‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ø–ª–æ—è** - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
10. **üì¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –û—Ç—á–µ—Ç –≤ Telegram (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–µ–ø–ª–æ—è

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ GitHub Actions:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub
2. –ù–∞–∂–º–∏—Ç–µ "Actions" –≤ –≤–µ—Ä—Ö–Ω–µ–º –º–µ–Ω—é
3. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π workflow run
4. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞

### –õ–æ–≥–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ nginx –ª–æ–≥–æ–≤
sudo tail -f /var/log/nginx/access.log
sudo tail -f /var/log/nginx/error.log

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
sudo systemctl status nginx
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –¥–µ–ø–ª–æ—è

### –¢—Ä–µ–±—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
sudo apt update && sudo apt upgrade -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ nginx (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
sudo apt install nginx -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js (–¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
curl -fsSL https://deb.nodesource.com/setup_22.x | sudo -E bash -
sudo apt-get install -y nodejs

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –¥–µ–ø–ª–æ—è
sudo mkdir -p /var/www/html
sudo chown -R –í–ê–®_–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨:–í–ê–®_–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ /var/www/html

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–ª—è SSH –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
sudo usermod -aG sudo –í–ê–®_–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨
```

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "Permission denied"

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ SSH –∫–ª—é—á–∞
chmod 600 ~/.ssh/github_actions_key

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh -i ~/.ssh/github_actions_key –í–ê–®_–õ–û–ì–ò–ù@–í–ê–®_–°–ï–†–í–ï–† "cat ~/.ssh/authorized_keys"
```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏ Next.js

```bash
# –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ (–ª–æ–∫–∞–ª—å–Ω–æ –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º)
rm -rf .next out node_modules/.cache
npm install
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–∞–ø–æ–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
ls -la images/ public/images/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
ssh –í–ê–®_–õ–û–ì–ò–ù@–í–ê–®_–°–ï–†–í–ï–† "ls -la /var/www/html/images/"
```

## ‚è™ –†—É—á–Ω–æ–π –æ—Ç–∫–∞—Ç

–ï—Å–ª–∏ –¥–µ–ø–ª–æ–π –ø—Ä–æ—à–µ–ª –Ω–µ—É–¥–∞—á–Ω–æ:

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh –í–ê–®_–õ–û–ì–ò–ù@–í–ê–®_–°–ï–†–í–ï–†

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
BACKUP_DIR=$(ls -t backup/ | head -1)
cp -r backup/$BACKUP_DIR/* /var/www/html/

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
sudo systemctl reload nginx
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –¥–µ–ø–ª–æ—è:

```bash
# –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh –í–ê–®_–õ–û–ì–ò–ù@–í–ê–®_–°–ï–†–í–ï–† "du -sh /var/www/html/"

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
ssh –í–ê–®_–õ–û–ì–ò–ù@–í–ê–®_–°–ï–†–í–ï–† "find /var/www/html/images/ -type f | wc -l"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–∞–π—Ç–∞
curl -I https://svyatobor.ru
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–û—Ç–¥–µ–ª—å–Ω—ã–π SSH –∫–ª—é—á** —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–µ–ø–ª–æ—è
2. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–∞–≤** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ—Å—Ç—É–ø–∞** –∫ —Å–µ—Ä–≤–µ—Ä—É
4. **–†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
5. **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –¥–µ–ø–ª–æ–µ–º

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:

```bash
# –õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
npm run build
ls -la out/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH –¥–æ—Å—Ç—É–ø–∞
ssh -i ~/.ssh/github_actions_key –í–ê–®_–õ–û–ì–ò–ù@–í–ê–®_–°–ï–†–í–ï–† "echo 'SSH OK'"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
curl -I https://–í–ê–®_–î–û–ú–ï–ù.ru
```

### –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ GitHub Actions**
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞**
3. **–í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ä—É—á–Ω–æ–π –æ—Ç–∫–∞—Ç –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏**
4. **–°–≤—è–∂–∏—Ç–µ—Å—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Timeweb**

---

## ‚úÖ –°—Ç–∞—Ç—É—Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- ‚úÖ GitHub Actions workflow —Å–æ–∑–¥–∞–Ω
- ‚úÖ –°–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω
- ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ GitHub
- ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ SSH –∫–ª—é—á–µ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSH –∫–ª—é—á–∏ –∏ —Å–µ–∫—Ä–µ—Ç—ã –≤ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è.